<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Птицеферма Pro</title>
    <style>
        :root {
            --primary: #4CAF50;
            --primary-dark: #388E3C;
            --secondary: #FF9800;
            --danger: #F44336;
            --success: #2196F3;
            --warning: #FFC107;
            --light: #f8f9fa;
            --dark: #343a40;
            --gray: #6c757d;
            --white: #ffffff;
            --border-radius: 12px;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            max-width: 100%;
            overflow-x: hidden;
            font-size: 16px;
            touch-action: manipulation;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Общий контейнер */
        .app-container {
            max-width: 100%;
            margin: 0 auto;
            background-color: #f5f7fa;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        /* Стили для ПК версии */
        .desktop-view {
            display: none;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header для ПК */
        .desktop-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .desktop-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .desktop-logo {
            font-size: 1.5rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .desktop-nav ul {
            display: flex;
            list-style: none;
        }

        .desktop-nav li {
            margin-left: 20px;
        }

        .desktop-nav a {
            color: white;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 8px;
            transition: var(--transition);
        }

        .desktop-nav a:hover, .desktop-nav a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .desktop-main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            overflow-y: auto; /* Исправление прокрутки на ПК */
            height: calc(100vh - 120px);
        }

        /* Стили для мобильной версии (приложение) */
        .mobile-view {
            display: block;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header как в мобильном приложении */
        .app-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 12px 16px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 60px;
        }

        .app-title {
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .app-title i {
            font-size: 1.3rem;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .header-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 6px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-btn:active {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* Bottom Navigation как в мобильных приложениях */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
            height: 60px;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            text-decoration: none;
            font-size: 0.75rem;
            padding: 4px 0;
            transition: var(--transition);
        }

        .nav-item.active {
            color: var(--primary);
        }

        .nav-item i {
            font-size: 1.2rem;
            margin-bottom: 4px;
        }

        /* Основной контент */
        .app-content {
            flex: 1;
            padding: 16px;
            padding-bottom: 76px; /* Высота bottom-nav + отступ */
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            height: calc(100vh - 120px);
        }

        /* Card */
        .card {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 16px;
            margin-bottom: 16px;
            transition: var(--transition);
            border: none;
            position: relative;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark);
        }

        /* Кнопки */
        .btn {
            padding: 12px 16px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
            text-align: center;
        }

        .btn i {
            font-size: 1rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:active, .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: scale(0.98);
        }

        .btn-secondary {
            background-color: var(--secondary);
            color: white;
        }

        .btn-secondary:active, .btn-secondary:hover {
            background-color: #E68900;
            transform: scale(0.98);
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        .btn-success:active, .btn-success:hover {
            background-color: #1976D2;
            transform: scale(0.98);
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:active, .btn-danger:hover {
            background-color: #D32F2F;
            transform: scale(0.98);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:active, .btn-outline:hover {
            background-color: rgba(76, 175, 80, 0.1);
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            width: 100%;
        }

        .btn-block {
            width: 100%;
        }

        .btn-sm {
            padding: 8px 12px;
            font-size: 0.85rem;
        }

        /* Формы */
        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
            font-size: 0.9rem;
        }

        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background-color: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
        }

        /* Сетка */
        .grid {
            display: grid;
            gap: 16px;
        }

        .grid-2 {
            grid-template-columns: 1fr 1fr;
        }

        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        /* Статистика */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 16px;
        }

        @media (min-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 16px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--primary);
        }

        .stat-card:nth-child(2) {
            border-left-color: var(--success);
        }

        .stat-card:nth-child(3) {
            border-left-color: var(--secondary);
        }

        .stat-card:nth-child(4) {
            border-left-color: var(--warning);
        }

        .stat-value {
            font-size: 1.3rem;
            font-weight: bold;
            margin: 8px 0;
            color: var(--primary);
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.8rem;
        }

        /* Таблицы для ПК */
        .table-container {
            overflow-x: auto;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 16px;
            background: white;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        .table th, .table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }

        .table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark);
            position: sticky;
            top: 0;
        }

        .table tbody tr:last-child td {
            border-bottom: none;
        }

        .table tbody tr:active, .table tbody tr:hover {
            background-color: #f5f5f5;
        }

        /* Статусы */
        .status-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            display: inline-block;
        }

        .status-active {
            background-color: #E8F5E9;
            color: var(--primary-dark);
        }

        .status-completed {
            background-color: #E3F2FD;
            color: #1565C0;
        }

        .status-delayed {
            background-color: #FFF8E1;
            color: #F57F17;
        }

        .status-expired {
            background-color: #FFEBEE;
            color: var(--danger);
        }

        /* Действия */
        .action-btn {
            padding: 6px 12px;
            margin: 0 2px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Модальные окна */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            animation: modalSlideUp 0.3s ease;
            position: relative;
        }

        @keyframes modalSlideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
        }

        .modal-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
            padding: 4px;
            border-radius: 50%;
        }

        .close-modal:active {
            background-color: #f5f5f5;
        }

        .modal-body {
            padding: 16px;
        }

        .modal-footer {
            padding: 16px;
            border-top: 1px solid #eee;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 16px;
            color: #ddd;
        }

        .empty-state p {
            font-size: 1rem;
            margin-bottom: 20px;
            color: var(--gray);
        }

        /* Уведомления */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 14px 20px;
            border-radius: var(--border-radius);
            color: white;
            box-shadow: var(--shadow);
            z-index: 1000;
            max-width: 90%;
            text-align: center;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            transform: translateX(150%);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background-color: var(--success);
        }

        .notification.error {
            background-color: var(--danger);
        }

        .notification.warning {
            background-color: var(--warning);
            color: #333;
        }

        .notification.info {
            background-color: var(--primary);
        }

        /* Список заказов в мобильном стиле */
        .order-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .order-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 16px;
            position: relative;
            border-left: 4px solid var(--primary);
        }

        .order-card.status-completed {
            border-left-color: var(--success);
        }

        .order-card.status-delayed {
            border-left-color: var(--warning);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .order-id {
            font-weight: 600;
            font-size: 1rem;
            color: var(--dark);
        }

        .order-status {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .order-customer {
            font-weight: 600;
            margin-bottom: 4px;
            font-size: 0.95rem;
        }

        .order-address {
            color: var(--gray);
            font-size: 0.85rem;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .order-products {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        .order-product-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px solid #eee;
        }

        .order-product-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .order-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 12px;
            border-top: 1px solid #eee;
            margin-top: 12px;
        }

        .order-total {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
        }

        .order-actions {
            display: flex;
            gap: 8px;
        }

        .order-date {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 4px;
        }

        /* Список комбикорма */
        .feed-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .feed-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 16px;
            position: relative;
        }

        .feed-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .feed-name {
            font-weight: 600;
            font-size: 1rem;
            color: var(--dark);
            margin-bottom: 4px;
        }

        .feed-status {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .feed-status-available {
            background-color: #E8F5E9;
            color: var(--primary-dark);
        }

        .feed-status-low {
            background-color: #FFF8E1;
            color: #F57F17;
        }

        .feed-status-out {
            background-color: #FFEBEE;
            color: var(--danger);
        }

        .feed-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .feed-detail {
            font-size: 0.9rem;
        }

        .feed-detail span {
            font-weight: 600;
            color: var(--dark);
        }

        .feed-footer {
            display: flex;
            justify-content: space-between;
            padding-top: 12px;
            border-top: 1px solid #eee;
        }

        /* Графическое отображение остатков комбикорма - НОВОЕ */
        .feed-stock-container {
            margin: 16px 0;
        }

        .stock-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .stock-bar-container {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .stock-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            border-radius: 10px;
            transition: width 0.3s ease;
            position: relative;
        }

        .stock-bar.low {
            background: linear-gradient(90deg, var(--warning), #F57F17);
        }

        .stock-bar.out {
            background: linear-gradient(90deg, var(--danger), #D32F2F);
        }

        .stock-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        /* Ползунок для изменения остатков - НОВОЕ */
        .slider-container {
            margin: 16px 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e0e0e0;
            outline: none;
            position: relative;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Поиск и фильтры */
        .search-bar {
            background: white;
            border-radius: var(--border-radius);
            padding: 12px 16px;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .search-input {
            flex: 1;
            border: none;
            font-size: 1rem;
            outline: none;
        }

        .search-btn {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 1.2rem;
            cursor: pointer;
        }

        /* Табы */
        .tabs {
            display: flex;
            background: white;
            border-radius: var(--border-radius);
            padding: 4px;
            margin-bottom: 16px;
            box-shadow: var(--shadow);
        }

        .tab {
            flex: 1;
            padding: 12px 8px;
            text-align: center;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .tab.active {
            background: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Выбор продуктов */
        .product-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .product-option {
            flex: 1;
            padding: 16px;
            border: 2px solid #eee;
            border-radius: var(--border-radius);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background-color: white;
        }

        .product-option:hover, .product-option.selected {
            border-color: var(--primary);
            background-color: rgba(76, 175, 80, 0.1);
        }

        .product-option i {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .product-option.selected i {
            color: var(--primary);
        }

        .product-details {
            display: none;
            margin-top: 16px;
            padding: 16px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
        }

        .product-details.active {
            display: block;
        }

        /* Адаптив для разных размеров экрана */
        @media (max-width: 767px) {
            /* Мобильная версия */
            .desktop-view {
                display: none;
            }
            
            .mobile-view {
                display: flex;
            }
            
            .app-header {
                height: 56px;
                padding: 8px 12px;
            }
            
            .app-title {
                font-size: 1rem;
            }
            
            .bottom-nav {
                height: 56px;
                padding: 4px 0;
            }
            
            .nav-item {
                font-size: 0.7rem;
            }
            
            .nav-item i {
                font-size: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .order-actions, .feed-footer {
                flex-direction: column;
                gap: 8px;
            }
            
            .btn {
                padding: 10px 14px;
                font-size: 0.9rem;
            }
        }

        @media (min-width: 768px) {
            /* ПК версия */
            .mobile-view {
                display: none;
            }
            
            .desktop-view {
                display: flex;
            }
            
            .app-container {
                max-width: 1200px;
                margin: 0 auto;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
                height: 100vh;
                border-left: 1px solid #ddd;
                border-right: 1px solid #ddd;
            }
            
            /* Стили для таблиц на ПК */
            .orders-table-container {
                margin-top: 20px;
            }
            
            /* Стили для форм на ПК */
            .modal-content {
                max-width: 800px;
            }
            
            .form-group {
                margin-bottom: 20px;
            }
            
            /* Стили для статистики на ПК */
            .dashboard-stats {
                margin-top: 20px;
            }
            
            /* Стили для карточек на ПК */
            .card {
                margin-bottom: 20px;
            }
        }

        @media (min-width: 1200px) {
            .app-container {
                max-width: 1200px;
            }
        }

        /* Анимации */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.3s ease;
        }

        /* Скроллбар */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        /* Fix для iOS */
        @supports (-webkit-touch-callout: none) {
            .app-content {
                height: calc(100vh - 120px);
            }
            
            .app-header {
                height: 66px;
                padding-top: constant(safe-area-inset-top);
                padding-top: env(safe-area-inset-top);
            }
            
            .bottom-nav {
                padding-bottom: constant(safe-area-inset-bottom);
                padding-bottom: env(safe-area-inset-bottom);
                height: calc(60px + env(safe-area-inset-bottom));
            }
        }
        
        /* Стили для кнопки экспорта в мобильной версии */
        .mobile-export-btn {
            margin-top: 16px;
            width: 100%;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Мобильная версия (по умолчанию) -->
    <div class="app-container mobile-view">
        <!-- Header -->
        <header class="app-header">
            <div class="app-title">
                <i class="fas fa-drumstick-bite"></i>
                <span>Птицеферма Pro</span>
            </div>
            <div class="header-actions">
                <button class="header-btn" id="settings-btn">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-content" id="main-content">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Выручка</div>
                        <div class="stat-value" id="total-revenue">0 ₽</div>
                        <div class="stat-label">За все время</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Прибыль</div>
                        <div class="stat-value" id="total-profit">0 ₽</div>
                        <div class="stat-label">Чистая</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Заказы</div>
                        <div class="stat-value" id="active-orders">0</div>
                        <div class="stat-label">Активные</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Доходность</div>
                        <div class="stat-value" id="profitability">0%</div>
                        <div class="stat-label">Рентабельность</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Последние заказы</h3>
                        <button class="btn btn-primary btn-sm" id="add-order-btn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div id="recent-orders-list" class="order-list">
                        <!-- Заказы будут загружены здесь -->
                    </div>
                    <div class="empty-state" id="recent-orders-empty">
                        <i class="fas fa-box-open"></i>
                        <p>Нет заказов</p>
                        <button class="btn btn-primary btn-block" id="add-order-btn-2">
                            <i class="fas fa-plus"></i> Добавить заказ
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Комбикорм</h3>
                        <button class="btn btn-secondary btn-sm" id="add-feed-btn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div id="feed-list-container" class="feed-list">
                        <!-- Комбикорм будет загружен здесь -->
                    </div>
                    <div class="empty-state" id="feed-empty">
                        <i class="fas fa-boxes"></i>
                        <p>Нет записей о комбикорме</p>
                        <button class="btn btn-secondary btn-block" id="add-feed-btn-2">
                            <i class="fas fa-plus"></i> Добавить запись
                        </button>
                    </div>
                </div>
            </div>

            <!-- Orders Tab -->
            <div id="orders-tab" class="tab-content">
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="orders-search" class="search-input" placeholder="Поиск по клиенту, адресу...">
                </div>

                <div class="tabs">
                    <div class="tab active" data-filter="all">Все</div>
                    <div class="tab" data-filter="active">Активные</div>
                    <div class="tab" data-filter="completed">Выполненные</div>
                    <div class="tab" data-filter="delayed">Отложенные</div>
                </div>

                <div id="orders-list" class="order-list">
                    <!-- Заказы будут загружены здесь -->
                </div>
                
                <div class="empty-state" id="orders-empty">
                    <i class="fas fa-box-open"></i>
                    <p>Нет заказов</p>
                    <button class="btn btn-primary btn-block" id="add-order-btn-3">
                        <i class="fas fa-plus"></i> Добавить заказ
                    </button>
                </div>
                
                <!-- Кнопка экспорта для мобильной версии -->
                <button class="btn btn-success mobile-export-btn" id="mobile-export-orders-btn">
                    <i class="fas fa-file-excel"></i> Экспорт заказов в Excel
                </button>
            </div>

            <!-- Purchases Tab -->
            <div id="purchases-tab" class="tab-content">
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="feeds-search" class="search-input" placeholder="Поиск по названию...">
                </div>

                <div id="purchases-list" class="feed-list">
                    <!-- Закупки будут загружены здесь -->
                </div>
                
                <div class="empty-state" id="purchases-empty">
                    <i class="fas fa-boxes"></i>
                    <p>Нет записей о закупках</p>
                    <button class="btn btn-secondary btn-block" id="add-feed-btn-3">
                        <i class="fas fa-plus"></i> Добавить закупку
                    </button>
                </div>
                
                <!-- Кнопка экспорта для мобильной версии -->
                <button class="btn btn-success mobile-export-btn" id="mobile-export-feeds-btn">
                    <i class="fas fa-file-excel"></i> Экспорт закупок в Excel
                </button>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics-tab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Финансовая аналитика</h3>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Выручка</div>
                            <div class="stat-value" id="analytics-revenue">0 ₽</div>
                            <div class="stat-label">Всего</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Расходы</div>
                            <div class="stat-value" id="analytics-expenses">0 ₽</div>
                            <div class="stat-label">На корм</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Прибыль</div>
                            <div class="stat-value" id="analytics-profit">0 ₽</div>
                            <div class="stat-label">Чистая</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Доходность</div>
                            <div class="stat-value" id="analytics-profitability">0%</div>
                            <div class="stat-label">Маржа</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Топ клиентов</h3>
                    </div>
                    <div id="top-customers-list" class="order-list">
                        <!-- Топ клиенты будут загружены здесь -->
                    </div>
                    <div class="empty-state" id="top-customers-empty">
                        <i class="fas fa-chart-bar"></i>
                        <p>Недостаточно данных</p>
                    </div>
                </div>
                
                <!-- Кнопка экспорта для мобильной версии -->
                <button class="btn btn-success mobile-export-btn" id="mobile-export-analytics-btn">
                    <i class="fas fa-file-excel"></i> Экспорт аналитики в Excel
                </button>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Настройки</h3>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="business-name">Название бизнеса</label>
                            <input type="text" id="business-name" class="form-control" placeholder="Птицеферма">
                        </div>
                        
                        <div class="form-group">
                            <label for="currency">Валюта</label>
                            <select id="currency" class="form-control">
                                <option value="RUB">Российский рубль (₽)</option>
                                <option value="USD">Доллар США ($)</option>
                                <option value="EUR">Евро (€)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Тема</label>
                            <div class="grid grid-2">
                                <button class="btn btn-outline" id="theme-light">Светлая</button>
                                <button class="btn btn-outline" id="theme-dark">Темная</button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Резервное копирование</label>
                            <div class="btn-group">
                                <button class="btn btn-primary" id="backup-data-btn">
                                    <i class="fas fa-save"></i> Сохранить
                                </button>
                                <button class="btn btn-secondary" id="restore-data-btn">
                                    <i class="fas fa-undo"></i> Восстановить
                                </button>
                                <button class="btn btn-danger" id="clear-data-btn">
                                    <i class="fas fa-trash"></i> Очистить
                                </button>
                            </div>
                        </div>
                        
                        <button class="btn btn-success btn-block" id="save-settings-btn">
                            <i class="fas fa-save"></i> Сохранить настройки
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a href="#" class="nav-item active" data-tab="dashboard-tab">
                <i class="fas fa-home"></i>
                <span>Главная</span>
            </a>
            <a href="#" class="nav-item" data-tab="orders-tab">
                <i class="fas fa-shopping-cart"></i>
                <span>Заказы</span>
            </a>
            <a href="#" class="nav-item" data-tab="purchases-tab">
                <i class="fas fa-boxes"></i>
                <span>Корм</span>
            </a>
            <a href="#" class="nav-item" data-tab="analytics-tab">
                <i class="fas fa-chart-bar"></i>
                <span>Аналитика</span>
            </a>
        </nav>
    </div>

    <!-- ПК версия -->
    <div class="app-container desktop-view">
        <!-- Header -->
        <header class="desktop-header">
            <div class="desktop-header-content">
                <div class="desktop-logo">
                    <i class="fas fa-drumstick-bite"></i>
                    <span>Птицеферма Pro</span>
                </div>
                <nav class="desktop-nav">
                    <ul>
                        <li><a href="#" class="nav-link active" data-tab="dashboard-tab">Главная</a></li>
                        <li><a href="#" class="nav-link" data-tab="orders-tab">Заказы</a></li>
                        <li><a href="#" class="nav-link" data-tab="purchases-tab">Корм</a></li>
                        <li><a href="#" class="nav-link" data-tab="analytics-tab">Аналитика</a></li>
                        <li><a href="#" class="nav-link" data-tab="settings-tab">Настройки</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- Main Content -->
        <main class="desktop-main">
            <!-- Dashboard Tab -->
            <div id="desktop-dashboard-tab" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Выручка</div>
                        <div class="stat-value" id="desktop-total-revenue">0 ₽</div>
                        <div class="stat-label">За все время</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Прибыль</div>
                        <div class="stat-value" id="desktop-total-profit">0 ₽</div>
                        <div class="stat-label">Чистая</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Заказы</div>
                        <div class="stat-value" id="desktop-active-orders">0</div>
                        <div class="stat-label">Активные</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Доходность</div>
                        <div class="stat-value" id="desktop-profitability">0%</div>
                        <div class="stat-label">Рентабельность</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Последние заказы</h3>
                        <button class="btn btn-primary" id="desktop-add-order-btn">
                            <i class="fas fa-plus"></i> Новый заказ
                        </button>
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Клиент</th>
                                    <th>Товары</th>
                                    <th>Сумма</th>
                                    <th>Статус</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="desktop-recent-orders-table">
                                <!-- Заказы будут загружены здесь -->
                            </tbody>
                        </table>
                        <div class="empty-state" id="desktop-recent-orders-empty">
                            <i class="fas fa-box-open"></i>
                            <p>Нет заказов</p>
                            <button class="btn btn-primary" id="desktop-add-order-btn-2">
                                <i class="fas fa-plus"></i> Добавить заказ
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Комбикорм</h3>
                        <button class="btn btn-secondary" id="desktop-add-feed-btn">
                            <i class="fas fa-plus"></i> Новая закупка
                        </button>
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Название</th>
                                    <th>Количество</th>
                                    <th>Цена</th>
                                    <th>Сумма</th>
                                    <th>Статус</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="desktop-feed-table">
                                <!-- Комбикорм будет загружен здесь -->
                            </tbody>
                        </table>
                        <div class="empty-state" id="desktop-feed-empty">
                            <i class="fas fa-boxes"></i>
                            <p>Нет записей о комбикорме</p>
                            <button class="btn btn-secondary" id="desktop-add-feed-btn-2">
                                <i class="fas fa-plus"></i> Добавить запись
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Orders Tab -->
            <div id="desktop-orders-tab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Все заказы</h3>
                        <div class="btn-group">
                            <button class="btn btn-primary" id="desktop-add-order-btn-3">
                                <i class="fas fa-plus"></i> Новый заказ
                            </button>
                            <button class="btn btn-success" id="export-orders-btn">
                                <i class="fas fa-file-excel"></i> Экспорт в Excel
                            </button>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 16px; margin-bottom: 16px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 200px;">
                            <input type="text" id="desktop-orders-search" class="form-control" placeholder="Поиск по клиенту, адресу...">
                        </div>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                            <select id="desktop-status-filter" class="form-control" style="width: auto;">
                                <option value="all">Все статусы</option>
                                <option value="active">Активные</option>
                                <option value="completed">Выполненные</option>
                                <option value="delayed">Отложенные</option>
                            </select>
                        </div>
                    </div>

                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Клиент</th>
                                    <th>Телефон</th>
                                    <th>Адрес</th>
                                    <th>Товары</th>
                                    <th>Сумма</th>
                                    <th>Дата заказа</th>
                                    <th>Дата доставки</th>
                                    <th>Статус</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="desktop-orders-table">
                                <!-- Заказы будут загружены здесь -->
                            </tbody>
                        </table>
                        <div class="empty-state" id="desktop-orders-empty">
                            <i class="fas fa-box-open"></i>
                            <p>Нет заказов</p>
                            <button class="btn btn-primary" id="desktop-add-order-btn-4">
                                <i class="fas fa-plus"></i> Добавить заказ
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Purchases Tab -->
            <div id="desktop-purchases-tab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Закупки комбикорма</h3>
                        <div class="btn-group">
                            <button class="btn btn-secondary" id="desktop-add-feed-btn-3">
                                <i class="fas fa-plus"></i> Новая закупка
                            </button>
                            <button class="btn btn-success" id="export-feeds-btn">
                                <i class="fas fa-file-excel"></i> Экспорт в Excel
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 16px;">
                        <input type="text" id="desktop-feeds-search" class="form-control" placeholder="Поиск по названию...">
                    </div>

                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Название</th>
                                    <th>Количество</th>
                                    <th>Цена за кг</th>
                                    <th>Сумма</th>
                                    <th>Поставщик</th>
                                    <th>Дата закупки</th>
                                    <th>Статус</th>
                                    <th>Действия</th>
                                </tr>
                            </thead>
                            <tbody id="desktop-purchases-table">
                                <!-- Закупки будут загружены здесь -->
                            </tbody>
                        </table>
                        <div class="empty-state" id="desktop-purchases-empty">
                            <i class="fas fa-boxes"></i>
                            <p>Нет записей о закупках</p>
                            <button class="btn btn-secondary" id="desktop-add-feed-btn-4">
                                <i class="fas fa-plus"></i> Добавить закупку
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="desktop-analytics-tab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Финансовая аналитика</h3>
                        <button class="btn btn-success" id="export-analytics-btn">
                            <i class="fas fa-file-excel"></i> Экспорт отчета
                        </button>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Выручка</div>
                            <div class="stat-value" id="desktop-analytics-revenue">0 ₽</div>
                            <div class="stat-label">Всего</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Расходы</div>
                            <div class="stat-value" id="desktop-analytics-expenses">0 ₽</div>
                            <div class="stat-label">На корм</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Прибыль</div>
                            <div class="stat-value" id="desktop-analytics-profit">0 ₽</div>
                            <div class="stat-label">Чистая</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Доходность</div>
                            <div class="stat-value" id="desktop-analytics-profitability">0%</div>
                            <div class="stat-label">Маржа</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Топ клиентов</h3>
                    </div>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Место</th>
                                    <th>Клиент</th>
                                    <th>Количество заказов</th>
                                    <th>Общая сумма</th>
                                </tr>
                            </thead>
                            <tbody id="desktop-top-customers-table">
                                <!-- Топ клиенты будут загружены здесь -->
                            </tbody>
                        </table>
                        <div class="empty-state" id="desktop-top-customers-empty">
                            <i class="fas fa-chart-bar"></i>
                            <p>Недостаточно данных</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="desktop-settings-tab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Настройки</h3>
                    </div>
                    <div style="padding: 20px;">
                        <div class="form-group">
                            <label for="desktop-business-name">Название бизнеса</label>
                            <input type="text" id="desktop-business-name" class="form-control" placeholder="Птицеферма">
                        </div>
                        
                        <div class="form-group">
                            <label for="desktop-currency">Валюта</label>
                            <select id="desktop-currency" class="form-control">
                                <option value="RUB">Российский рубль (₽)</option>
                                <option value="USD">Доллар США ($)</option>
                                <option value="EUR">Евро (€)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Тема</label>
                            <div class="grid grid-2">
                                <button class="btn btn-outline" id="desktop-theme-light">Светлая</button>
                                <button class="btn btn-outline" id="desktop-theme-dark">Темная</button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Резервное копирование</label>
                            <div class="btn-group">
                                <button class="btn btn-primary" id="desktop-backup-data-btn">
                                    <i class="fas fa-save"></i> Сохранить
                                </button>
                                <button class="btn btn-secondary" id="desktop-restore-data-btn">
                                    <i class="fas fa-undo"></i> Восстановить
                                </button>
                                <button class="btn btn-danger" id="desktop-clear-data-btn">
                                    <i class="fas fa-trash"></i> Очистить
                                </button>
                            </div>
                        </div>
                        
                        <button class="btn btn-success" id="desktop-save-settings-btn">
                            <i class="fas fa-save"></i> Сохранить настройки
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Order Modal (используется для обеих версий) -->
    <div class="modal" id="order-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="order-modal-title">Новый заказ</h3>
                <button class="close-modal" id="close-order-modal">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="order-id">
                
                <div class="form-group">
                    <label for="customer-name">Имя клиента *</label>
                    <input type="text" id="customer-name" class="form-control" placeholder="Иван Иванов">
                </div>
                
                <div class="form-group">
                    <label for="customer-phone">Телефон</label>
                    <input type="tel" id="customer-phone" class="form-control" placeholder="+7 (999) 123-45-67">
                </div>
                
                <div class="form-group">
                    <label for="order-address">Адрес доставки *</label>
                    <textarea id="order-address" class="form-control" rows="2" placeholder="г. Москва, ул. Пушкина, д. 10, кв. 5"></textarea>
                </div>
                
                <div class="form-group">
                    <label>Выберите товары *</label>
                    <div class="product-selector">
                        <div class="product-option" id="chicken-option">
                            <i class="fas fa-drumstick-bite"></i>
                            <div>Куриное мясо</div>
                        </div>
                        <div class="product-option" id="eggs-option">
                            <i class="fas fa-egg"></i>
                            <div>Яйца</div>
                        </div>
                    </div>
                </div>
                
                <!-- Детали куриного мяса -->
                <div class="product-details" id="chicken-details">
                    <h4>Куриное мясо</h4>
                    <div class="grid grid-2" style="margin-top: 12px;">
                        <div class="form-group">
                            <label for="chicken-quantity">Количество (кг) *</label>
                            <input type="number" id="chicken-quantity" class="form-control" min="0.1" step="0.1" placeholder="0.0">
                        </div>
                        <div class="form-group">
                            <label for="chicken-price">Цена за кг (₽) *</label>
                            <input type="number" id="chicken-price" class="form-control" min="1" step="1" placeholder="0">
                        </div>
                    </div>
                </div>
                
                <!-- Детали яиц -->
                <div class="product-details" id="eggs-details">
                    <h4>Яйца</h4>
                    <div class="grid grid-2" style="margin-top: 12px;">
                        <div class="form-group">
                            <label for="eggs-quantity">Количество (шт) *</label>
                            <input type="number" id="eggs-quantity" class="form-control" min="1" step="1" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label for="eggs-price">Цена за 10 шт (₽) *</label>
                            <input type="number" id="eggs-price" class="form-control" min="1" step="1" placeholder="0">
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-2">
                    <div class="form-group">
                        <label for="order-date">Дата заказа *</label>
                        <input type="date" id="order-date" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="delivery-date">Дата доставки *</label>
                        <input type="date" id="delivery-date" class="form-control">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="order-status">Статус *</label>
                    <select id="order-status" class="form-control">
                        <option value="active">Активный</option>
                        <option value="completed">Выполнен</option>
                        <option value="delayed">Отложен</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="order-notes">Примечания</label>
                    <textarea id="order-notes" class="form-control" rows="2" placeholder="Дополнительная информация"></textarea>
                </div>
                
                <div class="card">
                    <div class="form-group">
                        <label>Итого: <span id="order-total" class="stat-value">0 ₽</span></label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-order-btn">Отмена</button>
                <button class="btn btn-primary" id="save-order-btn">Сохранить заказ</button>
            </div>
        </div>
    </div>

    <!-- Feed Modal (используется для обеих версий) -->
    <div class="modal" id="feed-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="feed-modal-title">Новая закупка</h3>
                <button class="close-modal" id="close-feed-modal">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="feed-id">
                
                <div class="form-group">
                    <label for="feed-name">Название комбикорма *</label>
                    <input type="text" id="feed-name" class="form-control" placeholder="Комбикорм для бройлеров">
                </div>
                
                <div class="grid grid-2">
                    <div class="form-group">
                        <label for="feed-quantity">Количество (кг) *</label>
                        <input type="number" id="feed-quantity" class="form-control" min="1" step="1" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label for="feed-price">Цена за кг (₽) *</label>
                        <input type="number" id="feed-price" class="form-control" min="1" step="0.01" placeholder="0.00">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="feed-supplier">Поставщик</label>
                    <input type="text" id="feed-supplier" class="form-control" placeholder="ООО 'Агрофирма'">
                </div>
                
                <div class="grid grid-2">
                    <div class="form-group">
                        <label for="purchase-date">Дата закупки *</label>
                        <input type="date" id="purchase-date" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="expiry-date">Срок годности</label>
                        <input type="date" id="expiry-date" class="form-control">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="feed-status">Статус *</label>
                    <select id="feed-status" class="form-control">
                        <option value="available">В наличии</option>
                        <option value="low">Заканчивается</option>
                        <option value="out">Закончился</option>
                    </select>
                </div>
                
                <!-- Графическое отображение остатков - НОВОЕ -->
                <div class="feed-stock-container">
                    <div class="stock-label">
                        <span>Остаток на складе</span>
                        <span id="current-stock-value">0 кг</span>
                    </div>
                    <div class="stock-bar-container">
                        <div class="stock-bar" id="stock-bar">
                            <div class="stock-value" id="stock-value">0%</div>
                        </div>
                    </div>
                </div>
                
                <!-- Ползунок для изменения остатков - НОВОЕ -->
                <div class="slider-container">
                    <div class="slider-label">
                        <span>Изменить остаток</span>
                        <span id="slider-value">0 кг</span>
                    </div>
                    <input type="range" min="0" max="1000" value="0" class="slider" id="stock-slider">
                </div>
                
                <div class="form-group">
                    <label for="feed-notes">Примечания</label>
                    <textarea id="feed-notes" class="form-control" rows="2" placeholder="Дополнительная информация"></textarea>
                </div>
                
                <div class="card">
                    <div class="form-group">
                        <label>Стоимость: <span id="feed-total" class="stat-value">0 ₽</span></label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-feed-btn">Отмена</button>
                <button class="btn btn-secondary" id="save-feed-btn">Сохранить закупку</button>
            </div>
        </div>
    </div>

    <!-- Restore Modal -->
    <div class="modal" id="restore-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Восстановление данных</h3>
                <button class="close-modal" id="close-restore-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="restore-file">Выберите файл</label>
                    <input type="file" id="restore-file" class="form-control" accept=".json">
                </div>
                <div class="alert alert-warning" id="restore-warning" style="display: none;">
                    Все текущие данные будут заменены!
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-restore-btn">Отмена</button>
                <button class="btn btn-success" id="confirm-restore-btn">Восстановить</button>
            </div>
        </div>
    </div>

    <!-- Confirm Clear Modal -->
    <div class="modal" id="confirm-clear-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Подтверждение очистки</h3>
                <button class="close-modal" id="close-confirm-clear-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Вы уверены, что хотите удалить все данные? Это действие нельзя отменить!</p>
                <div class="form-group">
                    <label>Введите "УДАЛИТЬ" для подтверждения:</label>
                    <input type="text" id="confirm-clear-input" class="form-control">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-clear-btn">Отмена</button>
                <button class="btn btn-danger" id="confirm-clear-btn" disabled>Удалить все данные</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        class PoultryFarmApp {
            constructor() {
                this.orders = [];
                this.feeds = [];
                this.settings = {
                    businessName: "Птицеферма",
                    currency: "RUB",
                    theme: "light"
                };
                
                this.orderIdCounter = 1;
                this.feedIdCounter = 1;
                
                // Для мобильной версии
                this.currentTab = 'dashboard-tab';
                this.currentFilter = 'all';
                
                // Для ПК версии
                this.desktopCurrentTab = 'dashboard-tab';
                this.desktopCurrentFilter = 'all';
                
                this.notificationTimer = null;
                
                this.init();
            }
            
            init() {
                // Определяем тип устройства
                this.isMobile = window.innerWidth < 768;
                
                // Загрузка данных
                this.loadFromStorage();
                
                // Инициализация событий
                this.initEventListeners();
                
                // Обновление интерфейса
                this.updateUI();
                
                // Установка текущей даты
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('order-date').value = today;
                document.getElementById('purchase-date').value = today;
                document.getElementById('delivery-date').min = today;
                
                console.log('Приложение инициализировано');
            }
            
            initEventListeners() {
                // Обработчик изменения размера окна
                window.addEventListener('resize', () => {
                    const wasMobile = this.isMobile;
                    this.isMobile = window.innerWidth < 768;
                    
                    if (wasMobile !== this.isMobile) {
                        this.switchView(this.isMobile ? 'mobile' : 'desktop');
                    }
                });
                
                // Инициализация выбора продуктов
                this.initProductSelection();
                
                // Мобильная навигация
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        const tabId = item.getAttribute('data-tab');
                        this.switchTab(tabId, 'mobile');
                        
                        // Обновляем активный класс
                        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                        item.classList.add('active');
                    });
                });
                
                // ПК навигация
                document.querySelectorAll('.desktop-nav .nav-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const tabId = link.getAttribute('data-tab');
                        this.switchTab(tabId, 'desktop');
                        
                        // Обновляем активный класс
                        document.querySelectorAll('.desktop-nav .nav-link').forEach(l => l.classList.remove('active'));
                        link.classList.add('active');
                    });
                });
                
                // Фильтры для мобильной версии
                document.querySelectorAll('.tab[data-filter]').forEach(tab => {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.tab[data-filter]').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        this.currentFilter = tab.getAttribute('data-filter');
                        this.renderOrdersList('mobile');
                    });
                });
                
                // Фильтры для ПК версии
                document.getElementById('desktop-status-filter').addEventListener('change', () => {
                    this.desktopCurrentFilter = document.getElementById('desktop-status-filter').value;
                    this.renderOrdersTable('desktop');
                });
                
                // Кнопки добавления заказа (мобильная версия)
                document.querySelectorAll('[id^="add-order-btn"]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.openOrderModal();
                    });
                });
                
                // Кнопки добавления заказа (ПК версия)
                document.querySelectorAll('[id^="desktop-add-order-btn"]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.openOrderModal();
                    });
                });
                
                // Кнопки добавления комбикорма (мобильная версия)
                document.querySelectorAll('[id^="add-feed-btn"]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.openFeedModal();
                    });
                });
                
                // Кнопки добавления комбикорма (ПК версия)
                document.querySelectorAll('[id^="desktop-add-feed-btn"]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        this.openFeedModal();
                    });
                });
                
                // Модальные окна
                document.getElementById('close-order-modal').addEventListener('click', () => {
                    this.closeOrderModal();
                });
                
                document.getElementById('close-feed-modal').addEventListener('click', () => {
                    this.closeFeedModal();
                });
                
                document.getElementById('close-restore-modal').addEventListener('click', () => {
                    this.closeRestoreModal();
                });
                
                document.getElementById('close-confirm-clear-modal').addEventListener('click', () => {
                    this.closeConfirmClearModal();
                });
                
                // Расчет суммы заказа
                document.getElementById('chicken-quantity').addEventListener('input', () => this.calculateOrderTotal());
                document.getElementById('chicken-price').addEventListener('input', () => this.calculateOrderTotal());
                document.getElementById('eggs-quantity').addEventListener('input', () => this.calculateOrderTotal());
                document.getElementById('eggs-price').addEventListener('input', () => this.calculateOrderTotal());
                
                // Расчет суммы закупки
                document.getElementById('feed-quantity').addEventListener('input', () => this.calculateFeedTotal());
                document.getElementById('feed-price').addEventListener('input', () => this.calculateFeedTotal());
                
                // Поиск (мобильная версия)
                document.getElementById('orders-search').addEventListener('input', () => this.renderOrdersList('mobile'));
                document.getElementById('feeds-search').addEventListener('input', () => this.renderFeedsList('mobile'));
                
                // Поиск (ПК версия)
                document.getElementById('desktop-orders-search').addEventListener('input', () => this.renderOrdersTable('desktop'));
                document.getElementById('desktop-feeds-search').addEventListener('input', () => this.renderFeedsTable('desktop'));
                
                // Сохранение заказа
                document.getElementById('save-order-btn').addEventListener('click', () => this.saveOrder());
                document.getElementById('cancel-order-btn').addEventListener('click', () => this.closeOrderModal());
                
                // Сохранение закупки
                document.getElementById('save-feed-btn').addEventListener('click', () => this.saveFeed());
                document.getElementById('cancel-feed-btn').addEventListener('click', () => this.closeFeedModal());
                
                // Настройки (мобильная версия)
                document.getElementById('save-settings-btn').addEventListener('click', () => this.saveSettings());
                document.getElementById('theme-light').addEventListener('click', () => this.setTheme('light'));
                document.getElementById('theme-dark').addEventListener('click', () => this.setTheme('dark'));
                
                // Настройки (ПК версия)
                document.getElementById('desktop-save-settings-btn').addEventListener('click', () => this.saveSettings());
                document.getElementById('desktop-theme-light').addEventListener('click', () => this.setTheme('light'));
                document.getElementById('desktop-theme-dark').addEventListener('click', () => this.setTheme('dark'));
                
                // Резервное копирование (мобильная версия)
                document.getElementById('backup-data-btn').addEventListener('click', () => this.backupData());
                document.getElementById('restore-data-btn').addEventListener('click', () => this.openRestoreModal());
                document.getElementById('confirm-restore-btn').addEventListener('click', () => this.restoreData());
                document.getElementById('cancel-restore-btn').addEventListener('click', () => this.closeRestoreModal());
                
                // Резервное копирование (ПК версия)
                document.getElementById('desktop-backup-data-btn').addEventListener('click', () => this.backupData());
                document.getElementById('desktop-restore-data-btn').addEventListener('click', () => this.openRestoreModal());
                // confirm-restore-btn уже добавлен выше
                
                // Очистка данных (мобильная версия)
                document.getElementById('clear-data-btn').addEventListener('click', () => this.openConfirmClearModal());
                document.getElementById('confirm-clear-btn').addEventListener('click', () => this.clearAllData());
                document.getElementById('cancel-clear-btn').addEventListener('click', () => this.closeConfirmClearModal());
                document.getElementById('confirm-clear-input').addEventListener('input', () => this.checkClearConfirmation());
                
                // Очистка данных (ПК версия)
                document.getElementById('desktop-clear-data-btn').addEventListener('click', () => this.openConfirmClearModal());
                // confirm-clear-btn и другие уже добавлены выше
                
                // Открытие настроек через кнопку в header (мобильная версия)
                document.getElementById('settings-btn').addEventListener('click', () => {
                    this.switchTab('settings-tab', this.isMobile ? 'mobile' : 'desktop');
                    if (this.isMobile) {
                        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                    } else {
                        document.querySelectorAll('.desktop-nav .nav-link').forEach(l => l.classList.remove('active'));
                    }
                });
                
                // Экспорт данных (ПК версия)
                document.getElementById('export-orders-btn').addEventListener('click', () => this.exportOrdersToExcel());
                document.getElementById('export-feeds-btn').addEventListener('click', () => this.exportFeedsToExcel());
                document.getElementById('export-analytics-btn').addEventListener('click', () => this.exportAnalyticsToExcel());
                
                // Экспорт данных (мобильная версия)
                document.getElementById('mobile-export-orders-btn').addEventListener('click', () => this.exportOrdersToExcel());
                document.getElementById('mobile-export-feeds-btn').addEventListener('click', () => this.exportFeedsToExcel());
                document.getElementById('mobile-export-analytics-btn').addEventListener('click', () => this.exportAnalyticsToExcel());
                
                // Инициализация ползунка для остатков комбикорма
                this.initStockSlider();
            }
            
            initProductSelection() {
                const chickenOption = document.getElementById('chicken-option');
                const eggsOption = document.getElementById('eggs-option');
                const chickenDetails = document.getElementById('chicken-details');
                const eggsDetails = document.getElementById('eggs-details');
                
                // Инициализируем состояние
                chickenDetails.classList.remove('active');
                eggsDetails.classList.remove('active');
                
                chickenOption.addEventListener('click', () => {
                    chickenOption.classList.toggle('selected');
                    if (chickenOption.classList.contains('selected')) {
                        chickenDetails.classList.add('active');
                    } else {
                        chickenDetails.classList.remove('active');
                    }
                    this.calculateOrderTotal();
                });
                
                eggsOption.addEventListener('click', () => {
                    eggsOption.classList.toggle('selected');
                    if (eggsOption.classList.contains('selected')) {
                        eggsDetails.classList.add('active');
                    } else {
                        eggsDetails.classList.remove('active');
                    }
                    this.calculateOrderTotal();
                });
            }
            
            // Инициализация ползунка для остатков комбикорма - НОВОЕ
            initStockSlider() {
                const stockSlider = document.getElementById('stock-slider');
                const sliderValue = document.getElementById('slider-value');
                const currentStockValue = document.getElementById('current-stock-value');
                const stockBar = document.getElementById('stock-bar');
                const stockValue = document.getElementById('stock-value');
                
                if (!stockSlider) return;
                
                stockSlider.addEventListener('input', () => {
                    const value = parseInt(stockSlider.value);
                    sliderValue.textContent = `${value} кг`;
                    
                    // Обновляем графическое отображение
                    const max = parseInt(stockSlider.max);
                    const percentage = (value / max) * 100;
                    stockBar.style.width = `${percentage}%`;
                    stockValue.textContent = `${Math.round(percentage)}%`;
                    
                    // Меняем цвет в зависимости от значения
                    if (percentage < 20) {
                        stockBar.className = 'stock-bar out';
                    } else if (percentage < 40) {
                        stockBar.className = 'stock-bar low';
                    } else {
                        stockBar.className = 'stock-bar';
                    }
                });
            }
            
            switchView(view) {
                if (view === 'mobile') {
                    document.querySelector('.mobile-view').style.display = 'flex';
                    document.querySelector('.desktop-view').style.display = 'none';
                    this.renderMobileUI();
                } else {
                    document.querySelector('.mobile-view').style.display = 'none';
                    document.querySelector('.desktop-view').style.display = 'flex';
                    this.renderDesktopUI();
                }
            }
            
            switchTab(tabId, view) {
                if (view === 'mobile') {
                    this.currentTab = tabId;
                    
                    // Скрываем все табы мобильной версии
                    document.querySelectorAll('.mobile-view .tab-content').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    // Показываем выбранный таб
                    document.getElementById(tabId).classList.add('active');
                    
                    // Обновляем данные для некоторых табов
                    this.updateTabData(tabId, 'mobile');
                } else {
                    this.desktopCurrentTab = tabId;
                    
                    // Скрываем все табы ПК версии
                    document.querySelectorAll('.desktop-view .tab-content').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    // Показываем выбранный таб
                    document.getElementById(`desktop-${tabId}`).classList.add('active');
                    
                    // Обновляем данные для некоторых табов
                    this.updateTabData(tabId, 'desktop');
                }
            }
            
            updateTabData(tabId, view) {
                if (tabId === 'dashboard-tab') {
                    this.updateStats();
                    if (view === 'mobile') {
                        this.renderRecentOrders('mobile');
                        this.renderFeedList('mobile');
                    } else {
                        this.renderRecentOrders('desktop');
                        this.renderFeedList('desktop');
                    }
                } else if (tabId === 'orders-tab') {
                    if (view === 'mobile') {
                        this.renderOrdersList('mobile');
                    } else {
                        this.renderOrdersTable('desktop');
                    }
                } else if (tabId === 'purchases-tab') {
                    if (view === 'mobile') {
                        this.renderFeedsList('mobile');
                    } else {
                        this.renderFeedsTable('desktop');
                    }
                } else if (tabId === 'analytics-tab') {
                    this.updateStats();
                    if (view === 'mobile') {
                        this.renderTopCustomers('mobile');
                    } else {
                        this.renderTopCustomers('desktop');
                    }
                }
            }
            
            // Работа с заказами
            openOrderModal(order = null) {
                // Сброс формы
                document.getElementById('order-id').value = '';
                document.getElementById('customer-name').value = '';
                document.getElementById('customer-phone').value = '';
                document.getElementById('order-address').value = '';
                
                // Сброс выбора продуктов
                document.getElementById('chicken-option').classList.remove('selected');
                document.getElementById('eggs-option').classList.remove('selected');
                document.getElementById('chicken-details').classList.remove('active');
                document.getElementById('eggs-details').classList.remove('active');
                
                // Очистка полей продуктов
                document.getElementById('chicken-quantity').value = '';
                document.getElementById('chicken-price').value = '';
                document.getElementById('eggs-quantity').value = '';
                document.getElementById('eggs-price').value = '';
                
                // Установка дат
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('order-date').value = today;
                document.getElementById('delivery-date').value = '';
                document.getElementById('order-status').value = 'active';
                document.getElementById('order-notes').value = '';
                document.getElementById('order-total').textContent = '0 ₽';
                
                if (order) {
                    // Редактирование существующего заказа
                    document.getElementById('order-modal-title').textContent = 'Редактировать заказ';
                    document.getElementById('order-id').value = order.id;
                    document.getElementById('customer-name').value = order.customerName;
                    document.getElementById('customer-phone').value = order.customerPhone || '';
                    document.getElementById('order-address').value = order.address;
                    
                    // Восстановление выбора продуктов
                    if (order.products.chicken) {
                        document.getElementById('chicken-option').classList.add('selected');
                        document.getElementById('chicken-details').classList.add('active');
                        document.getElementById('chicken-quantity').value = order.products.chicken.quantity;
                        document.getElementById('chicken-price').value = order.products.chicken.price;
                    }
                    
                    if (order.products.eggs) {
                        document.getElementById('eggs-option').classList.add('selected');
                        document.getElementById('eggs-details').classList.add('active');
                        document.getElementById('eggs-quantity').value = order.products.eggs.quantity;
                        document.getElementById('eggs-price').value = order.products.eggs.price;
                    }
                    
                    document.getElementById('order-date').value = order.orderDate;
                    document.getElementById('delivery-date').value = order.deliveryDate;
                    document.getElementById('order-status').value = order.status;
                    document.getElementById('order-notes').value = order.notes || '';
                    
                    this.calculateOrderTotal();
                } else {
                    // Новый заказ
                    document.getElementById('order-modal-title').textContent = 'Новый заказ';
                }
                
                // Показываем модальное окно
                document.getElementById('order-modal').classList.add('active');
                
                // Фокус на первое поле
                setTimeout(() => {
                    document.getElementById('customer-name').focus();
                }, 300);
            }
            
            closeOrderModal() {
                document.getElementById('order-modal').classList.remove('active');
            }
            
            calculateOrderTotal() {
                let total = 0;
                
                if (document.getElementById('chicken-option').classList.contains('selected')) {
                    const quantity = parseFloat(document.getElementById('chicken-quantity').value) || 0;
                    const price = parseFloat(document.getElementById('chicken-price').value) || 0;
                    total += quantity * price;
                }
                
                if (document.getElementById('eggs-option').classList.contains('selected')) {
                    const quantity = parseInt(document.getElementById('eggs-quantity').value) || 0;
                    const price = parseFloat(document.getElementById('eggs-price').value) || 0;
                    // Цена за десяток, поэтому делим количество яиц на 10
                    total += (quantity / 10) * price;
                }
                
                const currencySymbol = this.getCurrencySymbol();
                document.getElementById('order-total').textContent = `${this.formatNumber(total)} ${currencySymbol}`;
            }
            
            saveOrder() {
                const customerId = document.getElementById('order-id').value;
                const customerName = document.getElementById('customer-name').value.trim();
                const customerPhone = document.getElementById('customer-phone').value.trim();
                const address = document.getElementById('order-address').value.trim();
                const orderDate = document.getElementById('order-date').value;
                const deliveryDate = document.getElementById('delivery-date').value;
                const status = document.getElementById('order-status').value;
                const notes = document.getElementById('order-notes').value.trim();
                
                // Валидация
                if (!customerName) {
                    this.showNotification('Введите имя клиента', 'error');
                    return;
                }
                
                if (!address) {
                    this.showNotification('Введите адрес доставки', 'error');
                    return;
                }
                
                if (!orderDate) {
                    this.showNotification('Выберите дату создания заказа', 'error');
                    return;
                }
                
                if (!deliveryDate) {
                    this.showNotification('Выберите дату доставки', 'error');
                    return;
                }
                
                let hasProduct = false;
                const products = {};
                
                if (document.getElementById('chicken-option').classList.contains('selected')) {
                    const quantity = parseFloat(document.getElementById('chicken-quantity').value);
                    const price = parseFloat(document.getElementById('chicken-price').value);
                    
                    if (!quantity || quantity <= 0) {
                        this.showNotification('Укажите корректное количество куриного мяса', 'error');
                        return;
                    }
                    
                    if (!price || price <= 0) {
                        this.showNotification('Укажите корректную цену за кг куриного мяса', 'error');
                        return;
                    }
                    
                    products.chicken = { quantity, price };
                    hasProduct = true;
                }
                
                if (document.getElementById('eggs-option').classList.contains('selected')) {
                    const quantity = parseInt(document.getElementById('eggs-quantity').value);
                    const price = parseFloat(document.getElementById('eggs-price').value);
                    
                    if (!quantity || quantity <= 0) {
                        this.showNotification('Укажите корректное количество яиц', 'error');
                        return;
                    }
                    
                    if (!price || price <= 0) {
                        this.showNotification('Укажите корректную цену за десяток яиц', 'error');
                        return;
                    }
                    
                    products.eggs = { quantity, price };
                    hasProduct = true;
                }
                
                if (!hasProduct) {
                    this.showNotification('Выберите хотя бы один продукт', 'error');
                    return;
                }
                
                // Расчет общей суммы
                let total = 0;
                if (products.chicken) {
                    total += products.chicken.quantity * products.chicken.price;
                }
                if (products.eggs) {
                    total += (products.eggs.quantity / 10) * products.eggs.price;
                }
                
                const order = {
                    id: customerId || this.generateOrderId(),
                    customerName,
                    customerPhone: customerPhone || null,
                    address,
                    products,
                    total,
                    orderDate,
                    deliveryDate,
                    status,
                    notes: notes || null,
                    createdAt: customerId ? null : new Date().toISOString()
                };
                
                if (customerId) {
                    // Обновление существующего заказа
                    const index = this.orders.findIndex(o => o.id === customerId);
                    if (index !== -1) {
                        this.orders[index] = order;
                        this.showNotification('Заказ успешно обновлен', 'success');
                    }
                } else {
                    // Добавление нового заказа
                    this.orders.push(order);
                    this.showNotification('Заказ успешно добавлен', 'success');
                }
                
                // Сохранение в localStorage
                this.saveToStorage();
                
                // Обновление интерфейса
                this.updateStats();
                this.renderRecentOrders(this.isMobile ? 'mobile' : 'desktop');
                if (this.isMobile) {
                    this.renderOrdersList('mobile');
                } else {
                    this.renderOrdersTable('desktop');
                }
                
                // Закрытие модального окна
                this.closeOrderModal();
            }
            
            deleteOrder(orderId) {
                if (confirm('Вы уверены, что хотите удалить этот заказ?')) {
                    this.orders = this.orders.filter(order => order.id !== orderId);
                    this.saveToStorage();
                    this.updateStats();
                    this.renderRecentOrders(this.isMobile ? 'mobile' : 'desktop');
                    if (this.isMobile) {
                        this.renderOrdersList('mobile');
                    } else {
                        this.renderOrdersTable('desktop');
                    }
                    this.renderTopCustomers(this.isMobile ? 'mobile' : 'desktop');
                    this.showNotification('Заказ удален', 'success');
                }
            }
            
            // Работа с закупками комбикорма
            openFeedModal(feed = null) {
                // Сброс формы
                document.getElementById('feed-id').value = '';
                document.getElementById('feed-name').value = '';
                document.getElementById('feed-quantity').value = '';
                document.getElementById('feed-price').value = '';
                document.getElementById('feed-supplier').value = '';
                document.getElementById('purchase-date').value = new Date().toISOString().split('T')[0];
                document.getElementById('expiry-date').value = '';
                document.getElementById('feed-status').value = 'available';
                document.getElementById('feed-notes').value = '';
                document.getElementById('feed-total').textContent = '0 ₽';
                
                // Сброс ползунка и графического отображения
                const stockSlider = document.getElementById('stock-slider');
                const sliderValue = document.getElementById('slider-value');
                const currentStockValue = document.getElementById('current-stock-value');
                const stockBar = document.getElementById('stock-bar');
                const stockValue = document.getElementById('stock-value');
                
                if (stockSlider) {
                    stockSlider.value = 0;
                    sliderValue.textContent = '0 кг';
                    currentStockValue.textContent = '0 кг';
                    stockBar.style.width = '0%';
                    stockValue.textContent = '0%';
                    stockBar.className = 'stock-bar';
                }
                
                if (feed) {
                    // Редактирование существующей закупки
                    document.getElementById('feed-modal-title').textContent = 'Редактировать закупку';
                    document.getElementById('feed-id').value = feed.id;
                    document.getElementById('feed-name').value = feed.name;
                    document.getElementById('feed-quantity').value = feed.quantity;
                    document.getElementById('feed-price').value = feed.price;
                    document.getElementById('feed-supplier').value = feed.supplier || '';
                    document.getElementById('purchase-date').value = feed.purchaseDate;
                    document.getElementById('expiry-date').value = feed.expiryDate || '';
                    document.getElementById('feed-status').value = feed.status;
                    document.getElementById('feed-notes').value = feed.notes || '';
                    
                    // Установка значений для ползунка и графического отображения
                    if (stockSlider) {
                        // Используем quantity как текущий остаток
                        const quantity = feed.quantity;
                        const max = Math.max(1000, quantity * 2); // Устанавливаем максимум как минимум в 2 раза больше текущего значения
                        
                        stockSlider.max = max;
                        stockSlider.value = quantity;
                        sliderValue.textContent = `${quantity} кг`;
                        currentStockValue.textContent = `${quantity} кг`;
                        
                        const percentage = (quantity / max) * 100;
                        stockBar.style.width = `${percentage}%`;
                        stockValue.textContent = `${Math.round(percentage)}%`;
                        
                        // Устанавливаем цвет в зависимости от процента
                        if (percentage < 20) {
                            stockBar.className = 'stock-bar out';
                        } else if (percentage < 40) {
                            stockBar.className = 'stock-bar low';
                        } else {
                            stockBar.className = 'stock-bar';
                        }
                    }
                    
                    this.calculateFeedTotal();
                } else {
                    // Новая закупка
                    document.getElementById('feed-modal-title').textContent = 'Новая закупка';
                    
                    // Устанавливаем стандартный максимум для нового товара
                    if (stockSlider) {
                        stockSlider.max = 1000;
                    }
                }
                
                // Показываем модальное окно
                document.getElementById('feed-modal').classList.add('active');
                
                // Фокус на первое поле
                setTimeout(() => {
                    document.getElementById('feed-name').focus();
                }, 300);
            }
            
            closeFeedModal() {
                document.getElementById('feed-modal').classList.remove('active');
            }
            
            calculateFeedTotal() {
                const quantity = parseFloat(document.getElementById('feed-quantity').value) || 0;
                const price = parseFloat(document.getElementById('feed-price').value) || 0;
                const total = quantity * price;
                
                const currencySymbol = this.getCurrencySymbol();
                document.getElementById('feed-total').textContent = `${this.formatNumber(total)} ${currencySymbol}`;
            }
            
            saveFeed() {
                const feedId = document.getElementById('feed-id').value;
                const name = document.getElementById('feed-name').value.trim();
                const quantity = parseFloat(document.getElementById('feed-quantity').value);
                const price = parseFloat(document.getElementById('feed-price').value);
                const supplier = document.getElementById('feed-supplier').value.trim();
                const purchaseDate = document.getElementById('purchase-date').value;
                const expiryDate = document.getElementById('expiry-date').value;
                const status = document.getElementById('feed-status').value;
                const notes = document.getElementById('feed-notes').value.trim();
                
                // Получаем значение с ползунка остатков
                const stockSlider = document.getElementById('stock-slider');
                const currentStock = stockSlider ? parseInt(stockSlider.value) : quantity;
                
                // Валидация
                if (!name) {
                    this.showNotification('Введите название комбикорма', 'error');
                    return;
                }
                
                if (!quantity || quantity <= 0) {
                    this.showNotification('Укажите корректное количество', 'error');
                    return;
                }
                
                if (!price || price <= 0) {
                    this.showNotification('Укажите корректную цену за кг', 'error');
                    return;
                }
                
                if (!purchaseDate) {
                    this.showNotification('Выберите дату закупки', 'error');
                    return;
                }
                
                // Расчет общей стоимости
                const total = quantity * price;
                
                const feed = {
                    id: feedId || this.generateFeedId(),
                    name,
                    quantity, // Это закупленное количество
                    currentStock, // Это текущий остаток на складе
                    price,
                    total,
                    supplier: supplier || null,
                    purchaseDate,
                    expiryDate: expiryDate || null,
                    status,
                    notes: notes || null,
                    createdAt: feedId ? null : new Date().toISOString()
                };
                
                if (feedId) {
                    // Обновление существующей закупки
                    const index = this.feeds.findIndex(f => f.id === feedId);
                    if (index !== -1) {
                        this.feeds[index] = feed;
                        this.showNotification('Закупка успешно обновлена', 'success');
                    }
                } else {
                    // Добавление новой закупки
                    this.feeds.push(feed);
                    this.showNotification('Закупка успешно добавлена', 'success');
                }
                
                // Сохранение в localStorage
                this.saveToStorage();
                
                // Обновление интерфейса
                this.updateStats();
                this.renderFeedList(this.isMobile ? 'mobile' : 'desktop');
                if (this.isMobile) {
                    this.renderFeedsList('mobile');
                } else {
                    this.renderFeedsTable('desktop');
                }
                
                // Закрытие модального окна
                this.closeFeedModal();
            }
            
            deleteFeed(feedId) {
                if (confirm('Вы уверены, что хотите удалить эту запись о закупке?')) {
                    this.feeds = this.feeds.filter(feed => feed.id !== feedId);
                    this.saveToStorage();
                    this.updateStats();
                    this.renderFeedList(this.isMobile ? 'mobile' : 'desktop');
                    if (this.isMobile) {
                        this.renderFeedsList('mobile');
                    } else {
                        this.renderFeedsTable('desktop');
                    }
                    this.showNotification('Закупка удалена', 'success');
                }
            }
            
            // Работа с настройками
            saveSettings() {
                // Для мобильной версии
                const businessName = document.getElementById('business-name').value.trim() || 
                                   document.getElementById('desktop-business-name').value.trim() || "Птицеферма";
                const currency = document.getElementById('currency').value || 
                               document.getElementById('desktop-currency').value || "RUB";
                
                this.settings.businessName = businessName;
                this.settings.currency = currency;
                
                // Сохраняем настройки
                this.saveToStorage();
                
                // Обновляем UI
                this.updateStats();
                this.showNotification('Настройки сохранены', 'success');
            }
            
            setTheme(theme) {
                this.settings.theme = theme;
                this.saveToStorage();
                
                if (theme === 'dark') {
                    document.body.classList.add('dark-theme');
                } else {
                    document.body.classList.remove('dark-theme');
                }
                
                this.showNotification(`Тема "${theme === 'dark' ? 'Темная' : 'Светлая'}" применена`, 'info');
            }
            
            // Работа с резервным копированием
            backupData() {
                const data = {
                    orders: this.orders,
                    feeds: this.feeds,
                    settings: this.settings,
                    orderIdCounter: this.orderIdCounter,
                    feedIdCounter: this.feedIdCounter,
                    backupDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                const dataStr = JSON.stringify(data, null, 2);
                const dataUri = 'application/json;charset=utf-8,' + encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `poultryfarm-backup-${new Date().toISOString().split('T')[0]}.json`;
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                this.showNotification('Резервная копия создана', 'success');
            }
            
            openRestoreModal() {
                document.getElementById('restore-file').value = '';
                document.getElementById('restore-warning').style.display = 'none';
                document.getElementById('restore-modal').classList.add('active');
            }
            
            closeRestoreModal() {
                document.getElementById('restore-modal').classList.remove('active');
            }
            
            restoreData() {
                const fileInput = document.getElementById('restore-file');
                const file = fileInput.files[0];
                
                if (!file) {
                    this.showNotification('Выберите файл для восстановления', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        // Проверка структуры данных
                        if (!data.orders || !data.feeds || !data.settings) {
                            throw new Error('Неверный формат файла');
                        }
                        
                        // Восстановление данных
                        this.orders = data.orders;
                        this.feeds = data.feeds;
                        this.settings = data.settings;
                        this.orderIdCounter = data.orderIdCounter || 1;
                        this.feedIdCounter = data.feedIdCounter || 1;
                        
                        // Сохранение и обновление интерфейса
                        this.saveToStorage();
                        this.updateUI();
                        
                        this.showNotification('Данные успешно восстановлены', 'success');
                        this.closeRestoreModal();
                    } catch (error) {
                        this.showNotification('Ошибка при восстановлении данных: ' + error.message, 'error');
                    }
                };
                
                reader.readAsText(file);
            }
            
            openConfirmClearModal() {
                document.getElementById('confirm-clear-input').value = '';
                document.getElementById('confirm-clear-btn').disabled = true;
                document.getElementById('confirm-clear-modal').classList.add('active');
            }
            
            closeConfirmClearModal() {
                document.getElementById('confirm-clear-modal').classList.remove('active');
            }
            
            checkClearConfirmation() {
                const value = document.getElementById('confirm-clear-input').value;
                document.getElementById('confirm-clear-btn').disabled = value !== 'УДАЛИТЬ';
            }
            
            clearAllData() {
                if (document.getElementById('confirm-clear-input').value === 'УДАЛИТЬ') {
                    if (confirm('Вы действительно хотите удалить ВСЕ данные? Это действие нельзя отменить!')) {
                        this.orders = [];
                        this.feeds = [];
                        this.orderIdCounter = 1;
                        this.feedIdCounter = 1;
                        
                        this.saveToStorage();
                        this.updateUI();
                        
                        this.showNotification('Все данные удалены', 'success');
                        this.closeConfirmClearModal();
                    }
                } else {
                    this.showNotification('Для подтверждения введите "УДАЛИТЬ"', 'error');
                }
            }
            
            // Экспорт в Excel
            exportOrdersToExcel() {
                if (this.orders.length === 0) {
                    this.showNotification('Нет заказов для экспорта', 'warning');
                    return;
                }
                
                // Создаем CSV с BOM для корректного отображения кириллицы
                const csvContent = this.generateOrdersCSV();
                this.downloadCSV(csvContent, 'заказы_птицефермы.csv');
                this.showNotification('Заказы экспортированы', 'success');
            }
            
            exportFeedsToExcel() {
                if (this.feeds.length === 0) {
                    this.showNotification('Нет записей о закупках для экспорта', 'warning');
                    return;
                }
                
                // Создаем CSV с BOM для корректного отображения кириллицы
                const csvContent = this.generateFeedsCSV();
                this.downloadCSV(csvContent, 'закупки_комбикорма.csv');
                this.showNotification('Закупки экспортированы', 'success');
            }
            
            exportAnalyticsToExcel() {
                const csvContent = this.generateAnalyticsCSV();
                this.downloadCSV(csvContent, 'аналитика_птицефермы.csv');
                this.showNotification('Отчет экспортирован', 'success');
            }
            
            generateOrdersCSV() {
                // Добавляем BOM для корректного отображения кириллицы в Excel
                const bom = '\uFEFF';
                
                const headers = [
                    'ID',
                    'Клиент',
                    'Телефон',
                    'Адрес',
                    'Товары',
                    'Количество',
                    'Цена',
                    'Сумма',
                    'Дата заказа',
                    'Дата доставки',
                    'Статус',
                    'Примечания'
                ];
                
                const rows = [headers.join(';')];
                
                this.orders.forEach(order => {
                    const products = [];
                    const quantities = [];
                    const prices = [];
                    
                    if (order.products.chicken) {
                        products.push('Куриное мясо');
                        quantities.push(`${order.products.chicken.quantity} кг`);
                        prices.push(`${order.products.chicken.price} ₽/кг`);
                    }
                    
                    if (order.products.eggs) {
                        products.push('Яйца');
                        quantities.push(`${order.products.eggs.quantity} шт`);
                        prices.push(`${order.products.eggs.price} ₽/дес`);
                    }
                    
                    const row = [
                        order.id,
                        order.customerName,
                        order.customerPhone || '',
                        order.address,
                        products.join(', '),
                        quantities.join(', '),
                        prices.join(', '),
                        `${order.total} ₽`,
                        this.formatDateForExport(order.orderDate),
                        this.formatDateForExport(order.deliveryDate),
                        this.getStatusText(order.status),
                        order.notes || ''
                    ].map(cell => `"${cell.toString().replace(/"/g, '""')}"`).join(';');
                    
                    rows.push(row);
                });
                
                return bom + rows.join('\n');
            }
            
            generateFeedsCSV() {
                // Добавляем BOM для корректного отображения кириллицы в Excel
                const bom = '\uFEFF';
                
                const headers = [
                    'ID',
                    'Название',
                    'Закуплено (кг)',
                    'Остаток (кг)',
                    'Цена за кг',
                    'Общая стоимость',
                    'Поставщик',
                    'Дата закупки',
                    'Срок годности',
                    'Статус',
                    'Примечания'
                ];
                
                const rows = [headers.join(';')];
                
                this.feeds.forEach(feed => {
                    const row = [
                        feed.id,
                        feed.name,
                        feed.quantity,
                        feed.currentStock || feed.quantity,
                        `${feed.price} ₽`,
                        `${feed.total} ₽`,
                        feed.supplier || '',
                        this.formatDateForExport(feed.purchaseDate),
                        feed.expiryDate ? this.formatDateForExport(feed.expiryDate) : '',
                        this.getFeedStatusText(feed.status),
                        feed.notes || ''
                    ].map(cell => `"${cell.toString().replace(/"/g, '""')}"`).join(';');
                    
                    rows.push(row);
                });
                
                return bom + rows.join('\n');
            }
            
            generateAnalyticsCSV() {
                // Добавляем BOM для корректного отображения кириллицы в Excel
                const bom = '\uFEFF';
                
                const stats = this.calculateStats();
                const currentDate = new Date().toLocaleDateString('ru-RU');
                
                const content = [
                    `Отчет по аналитике птицефермы`,
                    `Дата формирования: ${currentDate}`,
                    ``,
                    `Общая выручка: ${this.formatNumber(stats.totalRevenue)} ${this.getCurrencySymbol()}`,
                    `Общие расходы: ${this.formatNumber(stats.totalExpenses)} ${this.getCurrencySymbol()}`,
                    `Чистая прибыль: ${this.formatNumber(stats.totalProfit)} ${this.getCurrencySymbol()}`,
                    `Доходность: ${stats.profitability.toFixed(2)}%`,
                    ``,
                    `Активные заказы: ${stats.activeOrders}`,
                    `Выполненные заказы: ${stats.completedOrders}`,
                    `Отложенные заказы: ${stats.delayedOrders}`,
                    `Всего заказов: ${this.orders.length}`,
                    ``,
                    `Закупки комбикорма: ${this.feeds.length}`,
                    `Общий остаток: ${stats.totalStock} кг`
                ].join('\n');
                
                return bom + content;
            }
            
            formatDateForExport(dateString) {
                if (!dateString) return '';
                const date = new Date(dateString);
                return date.toLocaleDateString('ru-RU');
            }
            
            downloadCSV(content, filename) {
                const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', filename);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            }
            
            // Обновление интерфейса
            updateUI() {
                // Загрузка настроек
                const businessName = this.settings.businessName || "Птицеферма";
                const currency = this.settings.currency || "RUB";
                
                // Для мобильной версии
                document.getElementById('business-name').value = businessName;
                document.getElementById('currency').value = currency;
                
                // Для ПК версии
                document.getElementById('desktop-business-name').value = businessName;
                document.getElementById('desktop-currency').value = currency;
                
                // Установка темы
                this.setTheme(this.settings.theme);
                
                // Обновление статистики
                this.updateStats();
                
                // Рендер всех компонентов в зависимости от текущего вида
                if (this.isMobile) {
                    this.renderMobileUI();
                } else {
                    this.renderDesktopUI();
                }
            }
            
            renderMobileUI() {
                this.renderRecentOrders('mobile');
                this.renderFeedList('mobile');
                this.renderOrdersList('mobile');
                this.renderFeedsList('mobile');
                this.renderTopCustomers('mobile');
            }
            
            renderDesktopUI() {
                this.renderRecentOrders('desktop');
                this.renderFeedList('desktop');
                this.renderOrdersTable('desktop');
                this.renderFeedsTable('desktop');
                this.renderTopCustomers('desktop');
            }
            
            updateStats() {
                const stats = this.calculateStats();
                const currencySymbol = this.getCurrencySymbol();
                
                // Мобильная версия
                document.getElementById('total-revenue').textContent = `${this.formatNumber(stats.totalRevenue)} ${currencySymbol}`;
                document.getElementById('total-profit').textContent = `${this.formatNumber(stats.totalProfit)} ${currencySymbol}`;
                document.getElementById('active-orders').textContent = stats.activeOrders;
                document.getElementById('profitability').textContent = `${stats.profitability.toFixed(2)}%`;
                
                // ПК версия
                document.getElementById('desktop-total-revenue').textContent = `${this.formatNumber(stats.totalRevenue)} ${currencySymbol}`;
                document.getElementById('desktop-total-profit').textContent = `${this.formatNumber(stats.totalProfit)} ${currencySymbol}`;
                document.getElementById('desktop-active-orders').textContent = stats.activeOrders;
                document.getElementById('desktop-profitability').textContent = `${stats.profitability.toFixed(2)}%`;
                
                // Аналитика - мобильная версия
                document.getElementById('analytics-revenue').textContent = `${this.formatNumber(stats.totalRevenue)} ${currencySymbol}`;
                document.getElementById('analytics-expenses').textContent = `${this.formatNumber(stats.totalExpenses)} ${currencySymbol}`;
                document.getElementById('analytics-profit').textContent = `${this.formatNumber(stats.totalProfit)} ${currencySymbol}`;
                document.getElementById('analytics-profitability').textContent = `${stats.profitability.toFixed(2)}%`;
                
                // Аналитика - ПК версия
                document.getElementById('desktop-analytics-revenue').textContent = `${this.formatNumber(stats.totalRevenue)} ${currencySymbol}`;
                document.getElementById('desktop-analytics-expenses').textContent = `${this.formatNumber(stats.totalExpenses)} ${currencySymbol}`;
                document.getElementById('desktop-analytics-profit').textContent = `${this.formatNumber(stats.totalProfit)} ${currencySymbol}`;
                document.getElementById('desktop-analytics-profitability').textContent = `${stats.profitability.toFixed(2)}%`;
            }
            
            calculateStats() {
                let totalRevenue = 0;
                let totalExpenses = 0;
                let activeOrders = 0;
                let completedOrders = 0;
                let delayedOrders = 0;
                let totalStock = 0;
                
                // Считаем выручку и статусы заказов
                this.orders.forEach(order => {
                    totalRevenue += order.total;
                    
                    if (order.status === 'active') activeOrders++;
                    else if (order.status === 'completed') completedOrders++;
                    else if (order.status === 'delayed') delayedOrders++;
                });
                
                // Считаем расходы на комбикорм и общий остаток
                this.feeds.forEach(feed => {
                    totalExpenses += feed.total;
                    totalStock += feed.currentStock || feed.quantity;
                });
                
                // Рассчитываем прибыль и доходность
                const totalProfit = totalRevenue - totalExpenses;
                const profitability = totalRevenue > 0 ? (totalProfit / totalRevenue) * 100 : 0;
                
                return {
                    totalRevenue,
                    totalExpenses,
                    totalProfit,
                    profitability,
                    activeOrders,
                    completedOrders,
                    delayedOrders,
                    totalStock
                };
            }
            
            renderRecentOrders(view) {
                if (view === 'mobile') {
                    const recentOrdersContainer = document.getElementById('recent-orders-list');
                    const recentOrdersEmpty = document.getElementById('recent-orders-empty');
                    
                    // Получаем последние 3 заказа
                    const recentOrders = [...this.orders]
                        .sort((a, b) => new Date(b.orderDate) - new Date(a.orderDate))
                        .slice(0, 3);
                    
                    if (recentOrders.length === 0) {
                        recentOrdersContainer.innerHTML = '';
                        recentOrdersEmpty.style.display = 'block';
                        return;
                    }
                    
                    recentOrdersEmpty.style.display = 'none';
                    recentOrdersContainer.innerHTML = recentOrders.map(order => this.createOrderCard(order)).join('');
                } else {
                    const tableBody = document.getElementById('desktop-recent-orders-table');
                    const emptyState = document.getElementById('desktop-recent-orders-empty');
                    
                    // Получаем последние 5 заказов
                    const recentOrders = [...this.orders]
                        .sort((a, b) => new Date(b.orderDate) - new Date(a.orderDate))
                        .slice(0, 5);
                    
                    if (recentOrders.length === 0) {
                        tableBody.innerHTML = '';
                        emptyState.style.display = 'block';
                        return;
                    }
                    
                    emptyState.style.display = 'none';
                    tableBody.innerHTML = recentOrders.map(order => {
                        const products = [];
                        if (order.products.chicken) {
                            products.push(`Мясо: ${order.products.chicken.quantity} кг`);
                        }
                        if (order.products.eggs) {
                            products.push(`Яйца: ${order.products.eggs.quantity} шт`);
                        }
                        
                        return `
                            <tr>
                                <td>${order.id}</td>
                                <td>${order.customerName}</td>
                                <td>${products.join(', ')}</td>
                                <td>${this.formatNumber(order.total)} ${this.getCurrencySymbol()}</td>
                                <td>
                                    <span class="status-badge status-${order.status}">${this.getStatusText(order.status)}</span>
                                </td>
                                <td>
                                    <button class="btn btn-outline btn-sm" onclick="app.editOrder('${order.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="app.deleteOrder('${order.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    }).join('');
                }
            }
            
            renderOrdersList(view) {
                if (view === 'mobile') {
                    const ordersContainer = document.getElementById('orders-list');
                    const ordersEmpty = document.getElementById('orders-empty');
                    
                    let filteredOrders = [...this.orders];
                    
                    // Фильтр по статусу
                    if (this.currentFilter !== 'all') {
                        filteredOrders = filteredOrders.filter(order => order.status === this.currentFilter);
                    }
                    
                    // Поиск
                    const searchTerm = document.getElementById('orders-search').value.trim().toLowerCase();
                    if (searchTerm) {
                        filteredOrders = filteredOrders.filter(order => 
                            order.customerName.toLowerCase().includes(searchTerm) ||
                            (order.customerPhone && order.customerPhone.toLowerCase().includes(searchTerm)) ||
                            order.address.toLowerCase().includes(searchTerm)
                        );
                    }
                    
                    // Сортировка (новые сначала)
                    filteredOrders.sort((a, b) => new Date(b.orderDate) - new Date(a.orderDate));
                    
                    if (filteredOrders.length === 0) {
                        ordersContainer.innerHTML = '';
                        ordersEmpty.style.display = 'block';
                        return;
                    }
                    
                    ordersEmpty.style.display = 'none';
                    ordersContainer.innerHTML = filteredOrders.map(order => this.createOrderCard(order)).join('');
                }
            }
            
            renderOrdersTable(view) {
                if (view === 'desktop') {
                    const tableBody = document.getElementById('desktop-orders-table');
                    const emptyState = document.getElementById('desktop-orders-empty');
                    
                    let filteredOrders = [...this.orders];
                    
                    // Фильтр по статусу
                    if (this.desktopCurrentFilter !== 'all') {
                        filteredOrders = filteredOrders.filter(order => order.status === this.desktopCurrentFilter);
                    }
                    
                    // Поиск
                    const searchTerm = document.getElementById('desktop-orders-search').value.trim().toLowerCase();
                    if (searchTerm) {
                        filteredOrders = filteredOrders.filter(order => 
                            order.customerName.toLowerCase().includes(searchTerm) ||
                            (order.customerPhone && order.customerPhone.toLowerCase().includes(searchTerm)) ||
                            order.address.toLowerCase().includes(searchTerm)
                        );
                    }
                    
                    // Сортировка (новые сначала)
                    filteredOrders.sort((a, b) => new Date(b.orderDate) - new Date(a.orderDate));
                    
                    if (filteredOrders.length === 0) {
                        tableBody.innerHTML = '';
                        emptyState.style.display = 'block';
                        return;
                    }
                    
                    emptyState.style.display = 'none';
                    tableBody.innerHTML = filteredOrders.map(order => {
                        const products = [];
                        if (order.products.chicken) {
                            products.push(`Мясо: ${order.products.chicken.quantity} кг`);
                        }
                        if (order.products.eggs) {
                            products.push(`Яйца: ${order.products.eggs.quantity} шт`);
                        }
                        
                        return `
                            <tr>
                                <td>${order.id}</td>
                                <td>${order.customerName}</td>
                                <td>${order.customerPhone || ''}</td>
                                <td>${order.address}</td>
                                <td>${products.join(', ')}</td>
                                <td>${this.formatNumber(order.total)} ${this.getCurrencySymbol()}</td>
                                <td>${this.formatDate(order.orderDate)}</td>
                                <td>${this.formatDate(order.deliveryDate)}</td>
                                <td>
                                    <span class="status-badge status-${order.status}">${this.getStatusText(order.status)}</span>
                                </td>
                                <td>
                                    <button class="btn btn-outline btn-sm" onclick="app.editOrder('${order.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="app.deleteOrder('${order.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    }).join('');
                }
            }
            
            createOrderCard(order) {
                const productsHtml = [];
                
                if (order.products.chicken) {
                    productsHtml.push(`
                        <div class="order-product-item">
                            <div>Куриное мясо (${order.products.chicken.quantity} кг)</div>
                            <div>${this.formatNumber(order.products.chicken.quantity * order.products.chicken.price)} ₽</div>
                        </div>
                    `);
                }
                
                if (order.products.eggs) {
                    productsHtml.push(`
                        <div class="order-product-item">
                            <div>Яйца (${order.products.eggs.quantity} шт)</div>
                            <div>${this.formatNumber((order.products.eggs.quantity / 10) * order.products.eggs.price)} ₽</div>
                        </div>
                    `);
                }
                
                return `
                    <div class="order-card status-${order.status}">
                        <div class="order-header">
                            <div class="order-id">#${order.id}</div>
                            <div class="order-status status-${order.status}">${this.getStatusText(order.status)}</div>
                        </div>
                        <div class="order-customer">${order.customerName}</div>
                        <div class="order-address">${order.address}</div>
                        <div class="order-products">
                            ${productsHtml.join('')}
                        </div>
                        <div class="order-footer">
                            <div>
                                <div class="order-date">Заказ: ${this.formatDate(order.orderDate)} | Доставка: ${this.formatDate(order.deliveryDate)}</div>
                            </div>
                            <div class="order-actions">
                                <button class="btn btn-outline btn-sm" onclick="app.editOrder('${order.id}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-danger btn-sm" onclick="app.deleteOrder('${order.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <div class="order-total">${this.formatNumber(order.total)} ${this.getCurrencySymbol()}</div>
                    </div>
                `;
            }
            
            renderFeedList(view) {
                if (view === 'mobile') {
                    const feedListContainer = document.getElementById('feed-list-container');
                    const feedEmpty = document.getElementById('feed-empty');
                    
                    if (this.feeds.length === 0) {
                        feedListContainer.innerHTML = '';
                        feedEmpty.style.display = 'block';
                        return;
                    }
                    
                    feedEmpty.style.display = 'none';
                    
                    // Сортируем по статусу и названию
                    const sortedFeeds = [...this.feeds].sort((a, b) => {
                        if (a.status !== b.status) {
                            const statusOrder = { 'out': 0, 'low': 1, 'available': 2 };
                            return statusOrder[b.status] - statusOrder[a.status];
                        }
                        return a.name.localeCompare(b.name);
                    }).slice(0, 3);
                    
                    feedListContainer.innerHTML = sortedFeeds.map(feed => this.createFeedCard(feed)).join('');
                } else {
                    const tableBody = document.getElementById('desktop-feed-table');
                    const emptyState = document.getElementById('desktop-feed-empty');
                    
                    if (this.feeds.length === 0) {
                        tableBody.innerHTML = '';
                        emptyState.style.display = 'block';
                        return;
                    }
                    
                    emptyState.style.display = 'none';
                    
                    // Сортируем по статусу и названию
                    const sortedFeeds = [...this.feeds].sort((a, b) => {
                        if (a.status !== b.status) {
                            const statusOrder = { 'out': 0, 'low': 1, 'available': 2 };
                            return statusOrder[b.status] - statusOrder[a.status];
                        }
                        return a.name.localeCompare(b.name);
                    }).slice(0, 5);
                    
                    tableBody.innerHTML = sortedFeeds.map(feed => {
                        const currentStock = feed.currentStock || feed.quantity;
                        const stockPercentage = Math.round((currentStock / feed.quantity) * 100);
                        let stockClass = 'available';
                        if (stockPercentage < 20) stockClass = 'out';
                        else if (stockPercentage < 40) stockClass = 'low';
                        
                        return `
                            <tr>
                                <td>${feed.name}</td>
                                <td>${feed.quantity} кг</td>
                                <td>${feed.price} ₽/кг</td>
                                <td>${this.formatNumber(feed.total)} ₽</td>
                                <td>
                                    <span class="status-badge feed-status-${stockClass}">${currentStock} кг (${stockPercentage}%)</span>
                                </td>
                                <td>
                                    <button class="btn btn-outline btn-sm" onclick="app.editFeed('${feed.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="app.deleteFeed('${feed.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    }).join('');
                }
            }
            
            renderFeedsList(view) {
                if (view === 'mobile') {
                    const purchasesContainer = document.getElementById('purchases-list');
                    const purchasesEmpty = document.getElementById('purchases-empty');
                    
                    if (this.feeds.length === 0) {
                        purchasesContainer.innerHTML = '';
                        purchasesEmpty.style.display = 'block';
                        return;
                    }
                    
                    purchasesEmpty.style.display = 'none';
                    
                    // Фильтрация
                    let filteredFeeds = [...this.feeds];
                    const searchTerm = document.getElementById('feeds-search').value.trim().toLowerCase();
                    
                    if (searchTerm) {
                        filteredFeeds = filteredFeeds.filter(feed => 
                            feed.name.toLowerCase().includes(searchTerm) ||
                            (feed.supplier && feed.supplier.toLowerCase().includes(searchTerm))
                        );
                    }
                    
                    // Сортировка по дате закупки (новые сначала)
                    filteredFeeds.sort((a, b) => new Date(b.purchaseDate) - new Date(a.purchaseDate));
                    
                    purchasesContainer.innerHTML = filteredFeeds.map(feed => this.createFeedCard(feed)).join('');
                }
            }
            
            renderFeedsTable(view) {
                if (view === 'desktop') {
                    const tableBody = document.getElementById('desktop-purchases-table');
                    const emptyState = document.getElementById('desktop-purchases-empty');
                    
                    if (this.feeds.length === 0) {
                        tableBody.innerHTML = '';
                        emptyState.style.display = 'block';
                        return;
                    }
                    
                    emptyState.style.display = 'none';
                    
                    // Фильтрация
                    let filteredFeeds = [...this.feeds];
                    const searchTerm = document.getElementById('desktop-feeds-search').value.trim().toLowerCase();
                    
                    if (searchTerm) {
                        filteredFeeds = filteredFeeds.filter(feed => 
                            feed.name.toLowerCase().includes(searchTerm) ||
                            (feed.supplier && feed.supplier.toLowerCase().includes(searchTerm))
                        );
                    }
                    
                    // Сортировка по дате закупки (новые сначала)
                    filteredFeeds.sort((a, b) => new Date(b.purchaseDate) - new Date(a.purchaseDate));
                    
                    tableBody.innerHTML = filteredFeeds.map(feed => {
                        const currentStock = feed.currentStock || feed.quantity;
                        return `
                            <tr>
                                <td>${feed.id}</td>
                                <td>${feed.name}</td>
                                <td>${feed.quantity} кг</td>
                                <td>${feed.price} ₽</td>
                                <td>${this.formatNumber(feed.total)} ₽</td>
                                <td>${feed.supplier || ''}</td>
                                <td>${this.formatDate(feed.purchaseDate)}</td>
                                <td>
                                    <span class="status-badge feed-status-${feed.status}">${currentStock} кг</span>
                                </td>
                                <td>
                                    <button class="btn btn-outline btn-sm" onclick="app.editFeed('${feed.id}')">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="app.deleteFeed('${feed.id}')">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        `;
                    }).join('');
                }
            }
            
            // Создание карточки комбикорма с графическим отображением остатков - НОВОЕ
            createFeedCard(feed) {
                const currentStock = feed.currentStock || feed.quantity;
                const maxStock = Math.max(feed.quantity, currentStock, 100);
                const percentage = (currentStock / maxStock) * 100;
                
                let barClass = 'stock-bar';
                if (percentage < 20) {
                    barClass = 'stock-bar out';
                } else if (percentage < 40) {
                    barClass = 'stock-bar low';
                }
                
                return `
                    <div class="feed-card">
                        <div class="feed-header">
                            <div class="feed-name">${feed.name}</div>
                            <div class="feed-status feed-status-${feed.status}">${this.getFeedStatusText(feed.status)}</div>
                        </div>
                        <div class="feed-details">
                            <div class="feed-detail">Закуплено: <span>${feed.quantity} кг</span></div>
                            <div class="feed-detail">Цена: <span>${feed.price} ₽/кг</span></div>
                            <div class="feed-detail">Сумма: <span>${this.formatNumber(feed.total)} ₽</span></div>
                            ${feed.supplier ? `<div class="feed-detail">Поставщик: <span>${feed.supplier}</span></div>` : ''}
                            <div class="feed-detail">Дата: <span>${this.formatDate(feed.purchaseDate)}</span></div>
                            ${feed.expiryDate ? `<div class="feed-detail">Срок: <span>${this.formatDate(feed.expiryDate)}</span></div>` : ''}
                        </div>
                        
                        <!-- Графическое отображение остатков -->
                        <div class="feed-stock-container">
                            <div class="stock-label">
                                <span>Остаток на складе</span>
                                <span>${currentStock} кг (${Math.round(percentage)}%)</span>
                            </div>
                            <div class="stock-bar-container">
                                <div class="${barClass}" style="width: ${percentage}%">
                                    <div class="stock-value">${Math.round(percentage)}%</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feed-footer">
                            <button class="btn btn-outline btn-sm" onclick="app.editFeed('${feed.id}')">
                                <i class="fas fa-edit"></i> Изменить
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="app.deleteFeed('${feed.id}')">
                                <i class="fas fa-trash"></i> Удалить
                            </button>
                        </div>
                    </div>
                `;
            }
            
            renderTopCustomers(view) {
                if (view === 'mobile') {
                    const topCustomersContainer = document.getElementById('top-customers-list');
                    const topCustomersEmpty = document.getElementById('top-customers-empty');
                    
                    // Группируем заказы по клиентам
                    const customersMap = {};
                    this.orders.forEach(order => {
                        if (!customersMap[order.customerName]) {
                            customersMap[order.customerName] = {
                                name: order.customerName,
                                ordersCount: 0,
                                totalAmount: 0
                            };
                        }
                        customersMap[order.customerName].ordersCount++;
                        customersMap[order.customerName].totalAmount += order.total;
                    });
                    
                    // Сортируем клиентов по общей сумме
                    const topCustomers = Object.values(customersMap)
                        .sort((a, b) => b.totalAmount - a.totalAmount)
                        .slice(0, 5);
                    
                    if (topCustomers.length === 0) {
                        topCustomersContainer.innerHTML = '';
                        topCustomersEmpty.style.display = 'block';
                        return;
                    }
                    
                    topCustomersEmpty.style.display = 'none';
                    topCustomersContainer.innerHTML = topCustomers.map((customer, index) => `
                        <div class="order-card">
                            <div class="order-header">
                                <div class="order-id">#${index + 1}</div>
                                <div class="order-total">${this.formatNumber(customer.totalAmount)} ${this.getCurrencySymbol()}</div>
                            </div>
                            <div class="order-customer">${customer.name}</div>
                            <div class="order-address">Заказов: ${customer.ordersCount}</div>
                        </div>
                    `).join('');
                } else {
                    const tableBody = document.getElementById('desktop-top-customers-table');
                    const emptyState = document.getElementById('desktop-top-customers-empty');
                    
                    // Группируем заказы по клиентам
                    const customersMap = {};
                    this.orders.forEach(order => {
                        if (!customersMap[order.customerName]) {
                            customersMap[order.customerName] = {
                                name: order.customerName,
                                ordersCount: 0,
                                totalAmount: 0
                            };
                        }
                        customersMap[order.customerName].ordersCount++;
                        customersMap[order.customerName].totalAmount += order.total;
                    });
                    
                    // Сортируем клиентов по общей сумме
                    const topCustomers = Object.values(customersMap)
                        .sort((a, b) => b.totalAmount - a.totalAmount)
                        .slice(0, 10);
                    
                    if (topCustomers.length === 0) {
                        tableBody.innerHTML = '';
                        emptyState.style.display = 'block';
                        return;
                    }
                    
                    emptyState.style.display = 'none';
                    tableBody.innerHTML = topCustomers.map((customer, index) => `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${customer.name}</td>
                            <td>${customer.ordersCount}</td>
                            <td>${this.formatNumber(customer.totalAmount)} ${this.getCurrencySymbol()}</td>
                        </tr>
                    `).join('');
                }
            }
            
            generateOrderId() {
                return `ORD-${String(this.orderIdCounter++).padStart(5, '0')}`;
            }
            
            generateFeedId() {
                return `FED-${String(this.feedIdCounter++).padStart(5, '0')}`;
            }
            
            getStatusText(status) {
                switch (status) {
                    case 'active': return 'Активный';
                    case 'completed': return 'Выполнен';
                    case 'delayed': return 'Отложен';
                    default: return status;
                }
            }
            
            getFeedStatusText(status) {
                switch (status) {
                    case 'available': return 'В наличии';
                    case 'low': return 'Заканчивается';
                    case 'out': return 'Закончился';
                    default: return status;
                }
            }
            
            getCurrencySymbol() {
                switch (this.settings.currency) {
                    case 'USD': return '$';
                    case 'EUR': return '€';
                    case 'RUB':
                    default: return '₽';
                }
            }
            
            formatDate(dateString) {
                if (!dateString) return '';
                const date = new Date(dateString);
                return date.toLocaleDateString('ru-RU');
            }
            
            formatNumber(num) {
                return new Intl.NumberFormat('ru-RU', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                }).format(num);
            }
            
            // Уведомления
            showNotification(message, type = 'info') {
                // Очищаем предыдущий таймер, если есть
                if (this.notificationTimer) {
                    clearTimeout(this.notificationTimer);
                }
                
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type}`;
                notification.style.transform = 'translateX(0)';
                
                // Скрываем уведомление через 3 секунды
                this.notificationTimer = setTimeout(() => {
                    notification.style.transform = 'translateX(150%)';
                }, 3000);
            }
            
            // Работа с localStorage
            saveToStorage() {
                localStorage.setItem('poultryfarm_orders', JSON.stringify(this.orders));
                localStorage.setItem('poultryfarm_feeds', JSON.stringify(this.feeds));
                localStorage.setItem('poultryfarm_settings', JSON.stringify(this.settings));
                localStorage.setItem('poultryfarm_orderIdCounter', this.orderIdCounter.toString());
                localStorage.setItem('poultryfarm_feedIdCounter', this.feedIdCounter.toString());
            }
            
            loadFromStorage() {
                try {
                    const savedOrders = localStorage.getItem('poultryfarm_orders');
                    const savedFeeds = localStorage.getItem('poultryfarm_feeds');
                    const savedSettings = localStorage.getItem('poultryfarm_settings');
                    const savedOrderIdCounter = localStorage.getItem('poultryfarm_orderIdCounter');
                    const savedFeedIdCounter = localStorage.getItem('poultryfarm_feedIdCounter');
                    
                    if (savedOrders) {
                        this.orders = JSON.parse(savedOrders);
                    }
                    
                    if (savedFeeds) {
                        this.feeds = JSON.parse(savedFeeds);
                    }
                    
                    if (savedSettings) {
                        const loadedSettings = JSON.parse(savedSettings);
                        this.settings = { ...this.settings, ...loadedSettings };
                    }
                    
                    if (savedOrderIdCounter) {
                        this.orderIdCounter = parseInt(savedOrderIdCounter);
                    }
                    
                    if (savedFeedIdCounter) {
                        this.feedIdCounter = parseInt(savedFeedIdCounter);
                    }
                    
                    console.log('Данные загружены из localStorage');
                } catch (error) {
                    console.error('Ошибка при загрузке данных:', error);
                    this.showNotification('Ошибка при загрузке данных', 'error');
                }
            }
            
            // Методы для вызова извне
            editOrder(orderId) {
                const order = this.orders.find(o => o.id === orderId);
                if (order) {
                    this.openOrderModal(order);
                }
            }
            
            editFeed(feedId) {
                const feed = this.feeds.find(f => f.id === feedId);
                if (feed) {
                    this.openFeedModal(feed);
                }
            }
        }
        
        // Инициализация приложения после загрузки
        document.addEventListener('DOMContentLoaded', () => {
            window.app = new PoultryFarmApp();
        });
    </script>
</body>
</html>